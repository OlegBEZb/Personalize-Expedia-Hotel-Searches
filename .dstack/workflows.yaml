workflows:
  - name: download-data
    provider: python
    version: 3.8
    requirements: requirements_download_data.txt
    python_script: dstack_download_data.py
    artifacts:
      - data

  - name: train-catboost
    provider: python
    version: 3.8
    requirements: requirements.txt
    python_script: dstack_catboost_ranker.py
    depends-on:
      - download-data:train_val_test
    artifacts:
      - outputs
    resources:
      gpu: ${{ gpu }}

  - name: preprocess-data
    provider: python
    version: 3.8
    requirements: requirements.txt
    python_script: preprocess.py
    depends-on:
      - raw_data:latest
    artifacts:
      - data
    resources:
      gpu: ${{ gpu }}